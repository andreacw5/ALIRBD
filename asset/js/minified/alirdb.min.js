/*
*
*                                 MIT License
*
*    Copyright (c) 2017 Andrea Zago
*
*    Permission is hereby granted, free of charge, to any person obtaining a copy
*    of this software and associated documentation files (the "Software"), to deal
*    in the Software without restriction, including without limitation the rights
*    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
*    copies of the Software, and to permit persons to whom the Software is
*    furnished to do so, subject to the following conditions:
*
*    The above copyright notice and this permission notice shall be included in all
*    copies or substantial portions of the Software.
*
*    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
*    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
*    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
*    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
*    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
*    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
*    SOFTWARE.
*
*/
function goToHome(){searchType="",hideOpenWindow(),$("#mainsearchpage").removeAttr("hidden"),$("#listUserAppendElement").empty(),$("#appendgangmembers").empty()}function hideOpenWindow(){$("#playersearchview, #playermultyresult, #gangsearchview, #gangmultyresult, #noresult, #viewfactionlist").attr("hidden",!0)}function hideAllInfoPanel(){$("#userinfopanel, #userlicensepanel, #uservehiclepanel").hide().attr("hidden",!0),console.clear()}function showUserInfo(){hideAllInfoPanel(),$("#userinfopanel").show(300).removeAttr("hidden"),$("#infonav").addClass("active"),$("#licensenav, #groupsnav, #vehiclenav").attr("class","nav-item nav-link")}function showUserLicense(){hideAllInfoPanel(),$("#userlicensepanel").show(300).removeAttr("hidden"),$("#licensenav").addClass("active"),$("#infonav, #groupsnav, #vehiclenav").attr("class","nav-item nav-link")}function showUserVehicle(){hideAllInfoPanel(),$("#uservehiclepanel").show(300).removeAttr("hidden"),$("#vehiclenav").addClass("active"),$("#infonav, #groupsnav, #licensenav").attr("class","nav-item nav-link")}function showUserGang(){hideAllInfoPanel(),$("#infonav, #groupsnav, #licensenav, #vehiclenav").attr("class","nav-item nav-link")}function searchByPlayer(e){e||(e=$("#searchinput").val()),$("#mainsearchpage").attr("hidden",!0),$.ajax({url:playerDatabase,type:"GET",timeout:1500,contentType:"json",data:{q:e}}).done(function(e){e.length>1?showUserList(e):1===e.length?($("#playermultyresult").attr("hidden",!0),showUser(e)):$("#noresult").removeAttr("hidden")}).fail(function(){})}function showUserList(e){$("#playermultyresult").removeAttr("hidden");var a;e.length>searchLimiter?(a=searchLimiter,$("#resultsize").html(searchLimiter)):(a=e.length,$("#resultsize").html(e.length));for(var s=0;s<a;s++){var t=e[s].name,l=e[s].playerid,n=e[s].aliases,i=$('<a style="cursor:pointer;" id="'+l+'" data-id="'+l+'" class="list-group-item list-group-item-action flex-column align-items-start">    <div class="d-flex w-100 justify-content-between">      <h5 class="mb-1">'+t+'</h5>      <small><i class="fas fa-external-link-alt"></i></small>    </div>    <small>Playerid: '+l+" - Alias: "+n+"</small>  </a>");$("#listUserAppendElement").append(i)}for(var r=0;r<a;r++){var o=e[r].playerid;$("#"+o).on("click",function(){searchByPlayer($(this).data("id"))})}}function showUser(e){$("#playersearchview").removeAttr("hidden"),$("#usernameplace").html(e[0].name),$("#playeridplace").html(e[0].playerid),$("#userbankacc").html(e[0].bankacc),$("#usercash").html(e[0].cash),$("#useralias").html(e[0].aliases);var a;switch(e[0].donorlevel){case"1":a=$('<i class="fa fa-star"></i>');break;case"2":a=$('<i class="fa fa-star"></i><i class="fa fa-star"></i>');break;case"3":a=$('<i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i>');break;case"4":a=$('<i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i>');break;case"5":a=$('<i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i>');break;case"6":a=$('<i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i>');break;default:a=" Nessuno"}$("#userdonorlevel").html(a);var s;switch(e[0].coplevel){case"1":s=" Agente - Livello 1";break;case"2":s=" Agente Scelto - Livello 2";break;case"3":s=" Assistente - Livello 3";break;case"4":s=" Assistente Capo - Livello 4";break;case"5":s=" Sovrintendente - Livello 5";break;case"6":s=" Sovrintendente Capo - Livello 6";break;case"7":s=" Ispettore - Livello 7";break;case"8":s=" Ispettore Capo - Livello 8";break;case"9":s=" Commissario - Livello 9";break;case"10":s=" Questore - Livello 10";break;default:s=" Non è un'agente!"}$("#usercoplevel").html(s);var t;switch(e[0].mediclevel){case"1":t=" Medico - Livello 1";break;case"2":t=" Medico - Livello 2";break;case"3":t=" Medico - Livello 3";break;case"4":t=" Medico - Livello 4";break;case"5":t=" Medico - Livello 5";break;default:t=" Non è un medico!"}$("#usermedlevel").html(t),getGangName(e[0].playerid)}function searchByGang(e){e||(e=$("#searchinput").val()),$.ajax({url:gangDatabase,type:"GET",data:{q:e},dataType:"json",timeout:1500}).done(function(e){e.length>1?console.log(e):1===e.length?(console.log(e),showGang(e)):console.log("Nessun risultato")}).fail(function(){console.log("fail")})}function showGang(e){$("#mainsearchpage").attr("hidden",!0),$("#gangsearchview").removeAttr("hidden"),$("#gangview").removeAttr("hidden"),$("#singlegangname").html(e[0].name);var a=e[0].members.length;a>20?$("#gangplayernumber").html(a).attr("style","color:red"):a>=17?$("#gangplayernumber").html(a).attr("style","color:yellow"):$("#gangplayernumber").html(a);for(var s=0;s<e[0].members.length;s++){var t=e[0].members[s],l=s+1;getGangMembersName(t,e[0].owner);var n=$('<tr>    <th scope="row">'+l+'</th>    <td id="gangName'+t+'" ></td>    <td>'+t+'</td>    <td><i class="fas fa-external-link-alt"></i></td></tr>');$("#appendgangmembers").append(n)}}function getGangMembersName(e,a){$.ajax({url:playerDatabase,type:"GET",data:{q:e},dataType:"json",timeout:1500}).done(function(s){s[0].name?s[0].playerid===a?$("#gangName"+e).html(s[0].name+"  (Leader)").css("color","orange").attr("title","Questo utente è il capo della gang"):$("#gangName"+e).html(s[0].name):$("#gangName"+e).html("Utente non trovato").attr("style","color: red")})}function getGangName(e){$.ajax({url:gangDatabase,type:"GET",data:{q:e},dataType:"json",timeout:1500}).done(function(e){1===e.length?$("#usergangname").html(e[0].name).on("click",function(){searchByGang($(this).data("id"))}):$("#usergangname").html(" Nessuna")})}var searchType="",searchId="",searchData,searchLimiter=100,playerDatabase="http://37.59.102.107:5100/players",gangDatabase="http://37.59.102.107:5200/gangs";$(function(){$('[data-toggle="tooltip"]').tooltip()});